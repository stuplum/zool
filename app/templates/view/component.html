{% extends 'layout/app.html' %}

{% block head %}
{% if not hasExample %}
<link rel="stylesheet" href="/css/{{ componentName }}.css" />
{% endif %}
{% endblock %}

{% block content %}
<div class="zool-header">
    <h1>{{ componentName }}</h1>
    <h2>{{ location }}</h2>
</div>
<div class="zool-content">
    <div class="zool-content__section zool-usage">
        {{ usage | safe }}
    </div>
    {% if hasExample %}
    <div class="zool-content__section zool-component-frame">
        <a class="zool-component-frame__new-tab" href="/frame/{{ componentName }}" target="_blank" title="Open {{ componentName }} in a new tab">
            <img src="/assets/img/new-tab.gif" alt="Open example in new tab"/>
        </a>
        <iframe id="example" src="/frame/{{ componentName }}"></iframe>
    </div>
    {% endif %}

    {% if highlightedCss %}
    <div class="zool-content__section zool-highlighted">
        {{ highlightedCss | safe }}
    </div>
    {% endif %}
</div>
{% if not hasExample %}
<script src="/js/{{ componentName }}.js"></script>
{% endif %}

<script src="/assets/js/main.js"></script>
{% if hasExample %}
<script>

    function iframeResizer(iframe, delay, padding) {

        var initialHeight = iframe.offsetHeight;
        var currentHeight = initialHeight;

        iframe.style.height = initialHeight + 'px';

        padding = padding || 2;

        var interval = setInterval(function () {

            var newHeight = iframe.contentWindow.document.body.offsetHeight + padding;

            if (newHeight > initialHeight && newHeight !== currentHeight) {
                iframe.style.height = newHeight + 'px';
                currentHeight = newHeight;
            }

        }, delay);

        return {
            stop: function () {
                clearInterval(interval);
            }
        }
    }

    iframeResizer(document.querySelector('#example'), 2000);

</script>
{% endif %}
{% endblock %}